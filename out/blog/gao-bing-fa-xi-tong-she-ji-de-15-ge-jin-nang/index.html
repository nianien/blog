<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/blog/_next/static/media/e4af272ccee01ff0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/blog/_next/static/css/b383bfdf312065bd.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/blog/_next/static/chunks/webpack-9228b9b0c4ccfb4e.js"/><script src="/blog/_next/static/chunks/4bd1b696-e11d68ea3578b835.js" async=""></script><script src="/blog/_next/static/chunks/684-fc23d567a5facaf2.js" async=""></script><script src="/blog/_next/static/chunks/main-app-75103b4b1f3159f6.js" async=""></script><script src="/blog/_next/static/chunks/874-80549eca86098588.js" async=""></script><script src="/blog/_next/static/chunks/app/layout-32556b88729833ce.js" async=""></script><script src="/blog/_next/static/chunks/app/blog/%5B...slug%5D/page-b420037c820534af.js" async=""></script><meta name="next-size-adjust" content=""/><title>Skyfalling</title><meta name="description" content="分享技术、生活和思考的个人博客"/><link rel="icon" href="/favicon.svg"/><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/blog/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__className_067971"><div hidden=""><!--$--><!--/$--></div><div class="min-h-screen flex flex-col"><header class="bg-white shadow-sm"><nav class="mx-auto flex max-w-7xl items-center justify-between p-6 lg:px-8" aria-label="Global"><div class="flex lg:flex-1"><a class="-m-1.5 p-1.5" href="/blog/"><span class="sr-only">Skyfalling Blog</span><span class="text-2xl font-bold text-gray-900">Skyfalling</span></a></div><div class="flex lg:hidden"><button type="button" class="-m-2.5 inline-flex items-center justify-center rounded-md p-2.5 text-gray-700"><span class="sr-only">打开主菜单</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-6 w-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path></svg></button></div><div class="hidden lg:flex lg:gap-x-12"><a class="text-base font-semibold leading-6 transition-colors text-gray-900 hover:text-blue-600" href="/blog/">首页</a><a class="text-base font-semibold leading-6 transition-colors text-blue-600 border-b-2 border-blue-600 pb-1" href="/blog/blog/">博客</a><a class="text-base font-semibold leading-6 transition-colors text-gray-900 hover:text-blue-600" href="/blog/about/">关于</a></div><div class="hidden lg:flex lg:flex-1 lg:justify-end"><a class="text-base font-semibold leading-6 transition-colors text-gray-900 hover:text-blue-600" href="/blog/contact/">联系 <span aria-hidden="true">→</span></a></div></nav></header><main class="flex-1"><article class="py-24 sm:py-32"><div class="mx-auto max-w-3xl px-6 lg:px-8"><div class="xl:relative"><div class="mx-auto max-w-2xl"><div class="text-center"><time dateTime="2024-03-17" class="text-gray-500">2024年03月17日</time><h1 class="mt-6 text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl">高并发系统设计的15个锦囊</h1><p class="mt-6 text-lg leading-8 text-gray-600">记得很久之前，去面试过**字节跳动**。被三面的面试官问了一道场景设计题目：**如何设计一个高并发系统**。当时我回答得比较粗糙，最近回想起来，所以整理了设计高并发系统的15个锦囊，相信大家看完会有帮助的。 所谓设计**高并发**系统，就是设计一个系统，保证它**整体可用**的同时，能够**处理很高...</p><div class="mt-6 flex justify-center gap-2"><a class="rounded-full bg-gray-100 px-3 py-1 text-sm font-medium text-gray-700 hover:bg-gray-200" href="/blog/blog/tag/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/page/1/">系统架构</a></div></div><div class="mt-16 prose prose-lg prose-gray mx-auto"><div class="prose prose-lg prose-gray mx-auto">
<h1>高并发系统设计的15个锦囊</h1></p><p>记得很久之前，去面试过<strong>字节跳动</strong>。被三面的面试官问了一道场景设计题目：<strong>如何设计一个高并发系统</strong>。当时我回答得比较粗糙，最近回想起来，所以整理了设计高并发系统的15个锦囊，相信大家看完会有帮助的。</p><img src="/images/books/image_14_1.png" alt="" /><p><h3>如何理解高并发系统 <a href="#item-0-1" id="item-0-1"></a></h3></p><p>所谓设计<strong>高并发</strong>系统，就是设计一个系统，保证它<strong>整体可用</strong>的同时，能够<strong>处理很高的并发用户请求</strong>，能够承受<strong>很大的流量冲击</strong>。</p><p>我们要设计高并发的系统，那就需要处理好一些常见的系统瓶颈问题，如<strong>内存不足、磁盘空间不足，连接数不够，网络宽带不够</strong>等等，以应对突发的流量洪峰。</p><p><h3>1. 分而治之，横向扩展 <a href="#item-0-2" id="item-0-2"></a></h3></p><p>如果你<strong>只部署一个应用，只部署一台服务器</strong>，那抗住的流量请求是非常有限的。并且，单体的应用，有单点的风险，如果它挂了，那服务就不可用了。</p><p>因此，设计一个高并发系统，我们可以<strong>分而治之，横向扩展</strong>。也就是说，采用分布式部署的方式，部署多台服务器，把流量分流开，让每个服务器都承担一部分的并发和流量，提升<strong>整体系统的并发能力</strong>。</p><p><h3>2. 微服务拆分（系统拆分） <a href="#item-0-3" id="item-0-3"></a></h3></p><p>要提高系统的吞吐，提高系统的处理并发请求的能力。除了采用<strong>分布式部署的方式</strong>外，还可以做<strong>微服务拆分</strong>，这样就可以达到分摊请求流量的目的，提高了并发能力。</p><p>所谓的<strong>微服务拆分</strong>，其实就是把一个单体的应用，按功能单一性，拆分为多个服务模块。<strong>比如一个电商系统，拆分为用户系统、订单系统、商品系统等等</strong>。</p><img src="/images/books/image_21.png" alt="" /><p><h3>3. 分库分表 <a href="#item-0-4" id="item-0-4"></a></h3></p><p>当业务量暴增的话，MySQL单机<strong>磁盘容量会撑爆</strong>。并且，我们知道数据库连接数是有限的。<strong>在高并发的场景下</strong>，大量请求访问数据库，<code>MySQL</code>单机是扛不住的！高并发场景下，会出现<code>too many connections</code>报错。</p><p>所以高并发的系统，<strong>需要考虑拆分为多个数据库，来抗住高并发的毒打</strong>。而假如你的单表数据量非常大，存储和查询的性能就会遇到瓶颈了，如果你做了很多优化之后还是无法提升效率的时候，就需要考虑做<strong>分表</strong>了。一般千万级别数据量，就需要<strong>分表</strong>，每个表的数据量少一点，提升SQL查询性能。</p><p>当面试官问要求你设计一个高并发系统的时候，一般都要说到<strong>分库分表</strong>这个点。</p><p><h3>4. 池化技术 <a href="#item-0-5" id="item-0-5"></a></h3></p><p>在高并发的场景下，<strong>数据库连接数</strong>可能成为瓶颈，因为连接数是有限的。</p><p>我们的请求调用数据库时，都会先获取数据库的连接，然后依靠这个连接来查询数据，搞完收工，最后关闭连接，释放资源。如果我们不用数据库连接池的话，每次执行<code>SQL</code>，都要创建连接和销毁连接，这就会导致每个查询请求都变得更慢了，相应的，系统处理用户请求的能力就降低了。</p><p>因此，需要使用池化技术，即<strong>数据库连接池、HTTP 连接池、Redis 连接池</strong>等等。使用数据库连接池，可以避免每次查询都新建连接，减少不必要的资源开销，通过复用连接池，<strong>提高系统处理高并发请求的能力</strong>。</p><p>同理，我们使用线程池，也能<strong>让任务并行处理，更高效地完成任务</strong>。</p><p><h3>5. 主从分离 <a href="#item-0-6" id="item-0-6"></a></h3></p><p>通常来说，一台单机的MySQL服务器，可以支持<code>500</code>左右的<code>TPS</code>和<code>10000</code>左右的<code>QPS</code>，即单机支撑的<strong>请求访问是有限</strong>的。因此你做了分布式部署，部署了多台机器，部署了主数据库、从数据库。</p><p>但是，如果双十一搞活动，流量肯定会猛增的。如果所有的查询请求，都走主库的话，主库肯定扛不住，因为查询请求量是非常非常大的。因此一般都要求做<strong>主从分离</strong>，然后实时性要求不高的读请求，都去读从库，<strong>写的请求或者实时性要求高的请求，才走主库</strong>。这样就很好保护了主库，也提高了系统的吞吐。</p><p>当然，如果回答了主从分离，面试官可能扩展开问你<strong>主从复制原理，问你主从延迟问题</strong>等等，这块大家需要<strong>全方位复习好</strong>哈。</p><p><h3>6. 使用缓存 <a href="#item-0-7" id="item-0-7"></a></h3><p>无论是操作系统，浏览器，还是一些复杂的中间件，你都可以看到缓存的影子。我们使用缓存，主要是提升系统接口的性能，这样高并发场景，你的系统就可以支持更多的用户同时访问。</p><p>常用的缓存包括：<code>Redis</code>缓存，<code>JVM</code>本地缓存，<code>memcached</code>等等。就拿<code>Redis</code>来说，它单机就能轻轻松松应对几万的并发，你读场景的业务，可以用缓存来抗高并发。</p><p>缓存虽然用得爽，但是要<strong>注意缓存使用的一些问题</strong>：</p><p>* 缓存与数据库的一致性问题</p>
<p>* 缓存雪崩</p>
<p>* 缓存穿透</p>
<p>* 缓存击穿</p><h3>7. CDN，加速静态资源访问 <a href="#item-0-8" id="item-0-8"></a></h3></p><p>商品图片，<code>icon</code>等等静态资源，可以对页面做<strong>静态化处理，减少访问服务端的请求</strong>。如果用户分布在全国各地，有的在上海，有的在深圳，地域相差很远，网速也各不相同。为了让用户最快访问到页面，可以使用<code>CDN</code>。<code>CDN</code>可以让用户就近获取所需内容。</p><p>什么是CDN？</p><p>> Content Delivery Network/Content Distribution Network,翻译过来就是内容分发网络，它表示将静态资源分发到位于多个地理位置机房的服务器，可以做到数据就近访问，加速了静态资源的访问速度，因此让系统更好处理正常别的动态请求。</p><p><h3>8. 消息队列，削锋 <a href="#item-0-9" id="item-0-9"></a></h3><p>我们搞一些双十一、双十二等运营活动时，需要<strong>避免流量暴涨，打垮应用系统的风险</strong>。因此一般会引入消息队列，来应对<strong>高并发的场景</strong>。</p><img src="/images/books/image_9_1.png" alt="" /><p>假设你的应用系统每秒最多可以处理<code>2k</code>个请求，每秒却有<code>5k</code>的请求过来，可以引入消息队列，应用系统每秒从消息队列拉<code>2k</code>请求处理得了。</p><p>有些伙伴担心这样可能会出现<strong>消息积压</strong>的问题：</p><p>* 首先，搞一些运营活动，不会每时每刻都那么多请求过来你的系统（<strong>除非有人恶意攻击</strong>），高峰期过去后，积压的请求可以慢慢处理；</p>
<p>* 其次，如果消息队列长度超过最大数量，可以直接抛弃用户请求或跳转到错误页面；</p><h3>9. ElasticSearch <a href="#item-0-10" id="item-0-10"></a></h3></p><p><code>Elasticsearch</code>，大家都使用得比较多了吧，<strong>一般搜索功能都会用到它</strong>。它是一个分布式、高扩展、高实时的搜索与数据分析引擎，简称为<code>ES</code>。</p><p>我们在聊高并发，为啥聊到<code>ES</code>呢？因为<code>ES</code>可以扩容方便，天然支撑高并发。<strong>当数据量大的时候，不用动不动就加机器扩容，分库等等</strong>，可以考虑用<code>ES</code>来支持简单的查询搜索、统计类的操作。</p><p><h3>10. 降级熔断 <a href="#item-0-11" id="item-0-11"></a></h3></p><p><strong>熔断降级</strong>是保护系统的一种手段。当前互联网系统一般都是分布式部署的。而分布式系统中偶尔会出现某个基础服务不可用，最终导致整个系统不可用的情况, 这种现象被称为<strong>服务雪崩效应</strong>。</p><p>比如分布式调用链路<code>A->B->C....</code>，下图所示：</p><img src="/images/books/image_8_1.png" alt="" /><p>> 如果服务<code>C</code>出现问题，比如是因为慢<code>SQL</code>导致调用缓慢，那将导致<code>B</code>也会延迟，从而<code>A</code>也会延迟。堵住的<code>A</code>请求会消耗占用系统的线程、IO、CPU等资源。当请求<code>A</code>的服务越来越多，占用计算机的资源也越来越多，最终会导致系统瓶颈出现，造成其他的请求同样不可用，最后导致业务系统崩溃。</p><p>为了应对服务雪崩, 常见的做法是<strong>熔断和降级</strong>。最简单是加开关控制，当下游系统出问题时，开关打开降级，不再调用下游系统。还可以选用开源组件<code>Hystrix</code>来支持。</p><p>你要保证设计的系统能应对<strong>高并发场景</strong>，那肯定要考虑<strong>熔断降级</strong>逻辑进来。</p><p><h3>11. 限流 <a href="#item-0-12" id="item-0-12"></a></h3></p><p>限流也是我们应对高并发的一种方案。我们当然希望，在高并发大流量过来时，系统能全部请求都正常处理。但是有时候没办法，系统的CPU、网络带宽、内存、线程等资源都是有限的。因此，我们要考虑限流。</p><p>如果你的系统每秒扛住的请求是一千，<strong>如果一秒钟来了十万请求呢</strong>？换个角度就是说，高并发的时候，流量洪峰来了，超过系统的承载能力，怎么办呢？</p><p>这时候，我们可以采取限流方案。就是为了保护系统，多余的请求，直接丢弃。</p><p>> <strong>什么是限流</strong>：在计算机网络中，限流就是控制网络接口发送或接收请求的速率，它可防止DoS攻击和限制Web爬虫。限流，也称流量控制。是指系统在面临高并发，或者大流量请求的情况下，限制新的请求对系统的访问，从而保证系统的稳定性。</p><p>可以使用<code>Guava</code>的<code>RateLimiter</code>单机版限流，也可以使用<code>Redis</code>分布式限流，还可以使用阿里开源组件<code>sentinel</code>限流。</p><p>面试的时候，你说到限流这块的话？面试官很大概率会问你限流的算法，因此，大家在准备面试的时候，需要复习一下这几种经典的限流算法哈</p><p><h3>12. 异步 <a href="#item-0-13" id="item-0-13"></a></h3></p><p>> 回忆一下什么是同步，什么是异步呢？以<strong>方法调用</strong>为例，它代表<strong>调用方要阻塞等待被调用方法中的逻辑执行完成</strong>。这种方式下，当被调用方法响应时间较长时，会造成调用方长久的阻塞，在高并发下会造成整体系统性能下降甚至发生雪崩。异步调用恰恰相反，调用方不需要等待方法逻辑执行完成就可以返回执行其他的逻辑，在被调用方法执行完毕后再通过回调、事件通知等方式将结果反馈给调用方。</p><p>因此，设计一个高并发的系统，<strong>需要在恰当的场景使用异步</strong>。如何使用异步呢？后端可以借用消息队列实现。比如在海量秒杀请求过来时，先放到消息队列中，快速响应用户，告诉用户请求正在处理中，这样就可以释放资源来处理更多的请求。秒杀请求处理完后，通知用户秒杀抢购成功或者失败。</p><p><h3>13. 接口的常规优化 <a href="#item-0-14" id="item-0-14"></a></h3></p><p>设计一个高并发的系统，需要设计接口的性能足够好，这样系统在相同时间，就可以处理更多的请求。当说到这里的话，可以跟面试官说说接口优化的一些方案了。</p><img src="/images/books/image_31.png" alt="" /><p><h3>14. 压力测试确定系统瓶颈 <a href="#item-0-15" id="item-0-15"></a></h3></p><p>设计高并发系统，离不开最重要的一环，<strong>就是压力测试</strong>。就是在系统上线前，需要对系统进行压力测试，测清楚你的系统支撑的最大并发是多少，确定系统的瓶颈点，让自己心里有底，最好预防措施。</p><p>压测完要分析整个调用链路，性能可能出现问题是网络层（如带宽）、Nginx层、服务层、还是数据路缓存等中间件等等。</p><p><code>loadrunner</code>是一款不错的压力测试工具，<code>jmeter</code>则是接口性能测试工具，都可以来做下压测。</p><p><h3>15. 应对突发流量峰值：扩容+切流量 <a href="#item-0-16" id="item-0-16"></a></h3><p>如果是突发的流量高峰，除了降级、限流保证系统不跨，我们可以采用这两种方案，保证系统尽可能服务用户请求：</p><p>* 扩容：<strong>比如增加从库、提升配置的方式</strong>，提升系统/组件的流量承载能力。比如增加<code>MySQL、Redis</code>从库来处理查询请求。</p>
<p>* 切流量：<strong>服务多机房部署</strong>，如果高并发流量来了，把流量从一个机房切换到另一个机房。</p>
</div></div><div class="mt-16 flex items-center justify-between border-t border-gray-200 pt-8"><a class="relative z-10 rounded-md px-4 py-2 text-sm font-semibold leading-6 text-gray-900 hover:text-blue-600 hover:bg-gray-50" href="/blog/blog/">← 返回博客列表</a></div><div class="mt-8 grid grid-cols-1 gap-8 border-t border-gray-200 pt-8 lg:grid-cols-2"><div class="group"><div class="flex items-center gap-x-3"><div class="text-sm text-gray-500">上一篇</div></div><h3 class="mt-2 text-lg font-semibold leading-6 text-gray-900 group-hover:text-gray-600"><a href="/blog/blog/jia-gou-she-ji-mo-ban/"><span class="absolute inset-0"></span>架构设计模板</a></h3><p class="mt-3 text-sm leading-6 text-gray-600 line-clamp-2">最近一年的时间内，我参与了很多后端基础组件的设计、重构、重写、微服务化等工作，写了很多设计文档、与同事开了很多次技术研讨会，一直以来没有总结一套工作模板，以至于在开会时总有遗漏。今天我的朋友分享给了我一套架构设计模板，我针对文档做了一些总结，分享给大家： 总体来说，一个完善的设计需要考虑一下 11 ...</p></div><div class="group"><div class="flex items-center gap-x-3"><div class="text-sm text-gray-500">下一篇</div></div><h3 class="mt-2 text-lg font-semibold leading-6 text-gray-900 group-hover:text-gray-600"><a href="/blog/blog/cong-0-kai-shi-zuo-yi-ge-hou-tai-jia-gou/"><span class="absolute inset-0"></span>从0开始做一个后台项目架构</a></h3><p class="mt-3 text-sm leading-6 text-gray-600 line-clamp-2">--- layout:   title:...</p></div></div></div></div></div></article><!--$--><!--/$--></main><footer class="bg-gray-900"><div class="mx-auto max-w-7xl px-6 py-12 md:flex md:items-center md:justify-between lg:px-8"><div class="flex justify-center space-x-6 md:order-2"><a class="text-gray-400 hover:text-gray-300" href="/blog/about/">关于</a><a class="text-gray-400 hover:text-gray-300" href="/blog/blog/">博客</a><a class="text-gray-400 hover:text-gray-300" href="/blog/contact/">联系</a></div><div class="mt-8 md:order-1 md:mt-0"><p class="text-center text-xs leading-5 text-gray-400">© 2024 Skyfalling Blog. All rights reserved.</p></div></div></footer></div><script src="/blog/_next/static/chunks/webpack-9228b9b0c4ccfb4e.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[5651,[\"874\",\"static/chunks/874-80549eca86098588.js\",\"177\",\"static/chunks/app/layout-32556b88729833ce.js\"],\"default\"]\n3:I[7555,[],\"\"]\n4:I[1295,[],\"\"]\n5:I[6874,[\"874\",\"static/chunks/874-80549eca86098588.js\",\"909\",\"static/chunks/app/blog/%5B...slug%5D/page-b420037c820534af.js\"],\"\"]\n7:I[9665,[],\"OutletBoundary\"]\na:I[4911,[],\"AsyncMetadataOutlet\"]\nc:I[9665,[],\"ViewportBoundary\"]\ne:I[9665,[],\"MetadataBoundary\"]\n10:I[6614,[],\"\"]\n:HL[\"/blog/_next/static/media/e4af272ccee01ff0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/blog/_next/static/css/b383bfdf312065bd.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"Kw2pFI3i7zWLe0FOWC9Np\",\"p\":\"/blog\",\"c\":[\"\",\"blog\",\"gao-bing-fa-xi-tong-she-ji-de-15-ge-jin-nang\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"gao-bing-fa-xi-tong-she-ji-de-15-ge-jin-nang\",\"c\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/blog/_next/static/css/b383bfdf312065bd.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"zh-CN\",\"children\":[\"$\",\"body\",null,{\"className\":\"__className_067971\",\"children\":[\"$\",\"div\",null,{\"className\":\"min-h-screen flex flex-col\",\"children\":[[\"$\",\"$L2\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex-1\",\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}],[\"$\",\"footer\",null,{\"className\":\"bg-gray-900\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-7xl px-6 py-12 md:flex md:items-center md:justify-between lg:px-8\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex justify-center space-x-6 md:order-2\",\"children\":[[\"$\",\"$L5\",null,{\"href\":\"/about\",\"className\":\"text-gray-400 hover:text-gray-300\",\"children\":\"关于\"}],[\"$\",\"$L5\",null,{\"href\":\"/blog\",\"className\":\"text-gray-400 hover:text-gray-300\",\"children\":\"博客\"}],[\"$\",\"$L5\",null,{\"href\":\"/contact\",\"className\":\"text-gray-400 hover:text-gray-300\",\"children\":\"联系\"}]]}],[\"$\",\"div\",null,{\"className\":\"mt-8 md:order-1 md:mt-0\",\"children\":[\"$\",\"p\",null,{\"className\":\"text-center text-xs leading-5 text-gray-400\",\"children\":\"© 2024 Skyfalling Blog. All rights reserved.\"}]}]]}]}]]}]}]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"gao-bing-fa-xi-tong-she-ji-de-15-ge-jin-nang\",\"c\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L6\",null,[\"$\",\"$L7\",null,{\"children\":[\"$L8\",\"$L9\",[\"$\",\"$La\",null,{\"promise\":\"$@b\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"1_QbCd3e5MWLflyEuUrfuv\",{\"children\":[[\"$\",\"$Lc\",null,{\"children\":\"$Ld\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],[\"$\",\"$Le\",null,{\"children\":\"$Lf\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$10\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"11:\"$Sreact.suspense\"\n12:I[4911,[],\"AsyncMetadata\"]\nf:[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$11\",null,{\"fallback\":null,\"children\":[\"$\",\"$L12\",null,{\"promise\":\"$@13\"}]}]}]\n14:T3653,"])</script><script>self.__next_f.push([1,"\n\u003ch1\u003e高并发系统设计的15个锦囊\u003c/h1\u003e\u003c/p\u003e\u003cp\u003e记得很久之前，去面试过\u003cstrong\u003e字节跳动\u003c/strong\u003e。被三面的面试官问了一道场景设计题目：\u003cstrong\u003e如何设计一个高并发系统\u003c/strong\u003e。当时我回答得比较粗糙，最近回想起来，所以整理了设计高并发系统的15个锦囊，相信大家看完会有帮助的。\u003c/p\u003e\u003cimg src=\"/images/books/image_14_1.png\" alt=\"\" /\u003e\u003cp\u003e\u003ch3\u003e如何理解高并发系统 \u003ca href=\"#item-0-1\" id=\"item-0-1\"\u003e\u003c/a\u003e\u003c/h3\u003e\u003c/p\u003e\u003cp\u003e所谓设计\u003cstrong\u003e高并发\u003c/strong\u003e系统，就是设计一个系统，保证它\u003cstrong\u003e整体可用\u003c/strong\u003e的同时，能够\u003cstrong\u003e处理很高的并发用户请求\u003c/strong\u003e，能够承受\u003cstrong\u003e很大的流量冲击\u003c/strong\u003e。\u003c/p\u003e\u003cp\u003e我们要设计高并发的系统，那就需要处理好一些常见的系统瓶颈问题，如\u003cstrong\u003e内存不足、磁盘空间不足，连接数不够，网络宽带不够\u003c/strong\u003e等等，以应对突发的流量洪峰。\u003c/p\u003e\u003cp\u003e\u003ch3\u003e1. 分而治之，横向扩展 \u003ca href=\"#item-0-2\" id=\"item-0-2\"\u003e\u003c/a\u003e\u003c/h3\u003e\u003c/p\u003e\u003cp\u003e如果你\u003cstrong\u003e只部署一个应用，只部署一台服务器\u003c/strong\u003e，那抗住的流量请求是非常有限的。并且，单体的应用，有单点的风险，如果它挂了，那服务就不可用了。\u003c/p\u003e\u003cp\u003e因此，设计一个高并发系统，我们可以\u003cstrong\u003e分而治之，横向扩展\u003c/strong\u003e。也就是说，采用分布式部署的方式，部署多台服务器，把流量分流开，让每个服务器都承担一部分的并发和流量，提升\u003cstrong\u003e整体系统的并发能力\u003c/strong\u003e。\u003c/p\u003e\u003cp\u003e\u003ch3\u003e2. 微服务拆分（系统拆分） \u003ca href=\"#item-0-3\" id=\"item-0-3\"\u003e\u003c/a\u003e\u003c/h3\u003e\u003c/p\u003e\u003cp\u003e要提高系统的吞吐，提高系统的处理并发请求的能力。除了采用\u003cstrong\u003e分布式部署的方式\u003c/strong\u003e外，还可以做\u003cstrong\u003e微服务拆分\u003c/strong\u003e，这样就可以达到分摊请求流量的目的，提高了并发能力。\u003c/p\u003e\u003cp\u003e所谓的\u003cstrong\u003e微服务拆分\u003c/strong\u003e，其实就是把一个单体的应用，按功能单一性，拆分为多个服务模块。\u003cstrong\u003e比如一个电商系统，拆分为用户系统、订单系统、商品系统等等\u003c/strong\u003e。\u003c/p\u003e\u003cimg src=\"/images/books/image_21.png\" alt=\"\" /\u003e\u003cp\u003e\u003ch3\u003e3. 分库分表 \u003ca href=\"#item-0-4\" id=\"item-0-4\"\u003e\u003c/a\u003e\u003c/h3\u003e\u003c/p\u003e\u003cp\u003e当业务量暴增的话，MySQL单机\u003cstrong\u003e磁盘容量会撑爆\u003c/strong\u003e。并且，我们知道数据库连接数是有限的。\u003cstrong\u003e在高并发的场景下\u003c/strong\u003e，大量请求访问数据库，\u003ccode\u003eMySQL\u003c/code\u003e单机是扛不住的！高并发场景下，会出现\u003ccode\u003etoo many connections\u003c/code\u003e报错。\u003c/p\u003e\u003cp\u003e所以高并发的系统，\u003cstrong\u003e需要考虑拆分为多个数据库，来抗住高并发的毒打\u003c/strong\u003e。而假如你的单表数据量非常大，存储和查询的性能就会遇到瓶颈了，如果你做了很多优化之后还是无法提升效率的时候，就需要考虑做\u003cstrong\u003e分表\u003c/strong\u003e了。一般千万级别数据量，就需要\u003cstrong\u003e分表\u003c/strong\u003e，每个表的数据量少一点，提升SQL查询性能。\u003c/p\u003e\u003cp\u003e当面试官问要求你设计一个高并发系统的时候，一般都要说到\u003cstrong\u003e分库分表\u003c/strong\u003e这个点。\u003c/p\u003e\u003cp\u003e\u003ch3\u003e4. 池化技术 \u003ca href=\"#item-0-5\" id=\"item-0-5\"\u003e\u003c/a\u003e\u003c/h3\u003e\u003c/p\u003e\u003cp\u003e在高并发的场景下，\u003cstrong\u003e数据库连接数\u003c/strong\u003e可能成为瓶颈，因为连接数是有限的。\u003c/p\u003e\u003cp\u003e我们的请求调用数据库时，都会先获取数据库的连接，然后依靠这个连接来查询数据，搞完收工，最后关闭连接，释放资源。如果我们不用数据库连接池的话，每次执行\u003ccode\u003eSQL\u003c/code\u003e，都要创建连接和销毁连接，这就会导致每个查询请求都变得更慢了，相应的，系统处理用户请求的能力就降低了。\u003c/p\u003e\u003cp\u003e因此，需要使用池化技术，即\u003cstrong\u003e数据库连接池、HTTP 连接池、Redis 连接池\u003c/strong\u003e等等。使用数据库连接池，可以避免每次查询都新建连接，减少不必要的资源开销，通过复用连接池，\u003cstrong\u003e提高系统处理高并发请求的能力\u003c/strong\u003e。\u003c/p\u003e\u003cp\u003e同理，我们使用线程池，也能\u003cstrong\u003e让任务并行处理，更高效地完成任务\u003c/strong\u003e。\u003c/p\u003e\u003cp\u003e\u003ch3\u003e5. 主从分离 \u003ca href=\"#item-0-6\" id=\"item-0-6\"\u003e\u003c/a\u003e\u003c/h3\u003e\u003c/p\u003e\u003cp\u003e通常来说，一台单机的MySQL服务器，可以支持\u003ccode\u003e500\u003c/code\u003e左右的\u003ccode\u003eTPS\u003c/code\u003e和\u003ccode\u003e10000\u003c/code\u003e左右的\u003ccode\u003eQPS\u003c/code\u003e，即单机支撑的\u003cstrong\u003e请求访问是有限\u003c/strong\u003e的。因此你做了分布式部署，部署了多台机器，部署了主数据库、从数据库。\u003c/p\u003e\u003cp\u003e但是，如果双十一搞活动，流量肯定会猛增的。如果所有的查询请求，都走主库的话，主库肯定扛不住，因为查询请求量是非常非常大的。因此一般都要求做\u003cstrong\u003e主从分离\u003c/strong\u003e，然后实时性要求不高的读请求，都去读从库，\u003cstrong\u003e写的请求或者实时性要求高的请求，才走主库\u003c/strong\u003e。这样就很好保护了主库，也提高了系统的吞吐。\u003c/p\u003e\u003cp\u003e当然，如果回答了主从分离，面试官可能扩展开问你\u003cstrong\u003e主从复制原理，问你主从延迟问题\u003c/strong\u003e等等，这块大家需要\u003cstrong\u003e全方位复习好\u003c/strong\u003e哈。\u003c/p\u003e\u003cp\u003e\u003ch3\u003e6. 使用缓存 \u003ca href=\"#item-0-7\" id=\"item-0-7\"\u003e\u003c/a\u003e\u003c/h3\u003e\u003cp\u003e无论是操作系统，浏览器，还是一些复杂的中间件，你都可以看到缓存的影子。我们使用缓存，主要是提升系统接口的性能，这样高并发场景，你的系统就可以支持更多的用户同时访问。\u003c/p\u003e\u003cp\u003e常用的缓存包括：\u003ccode\u003eRedis\u003c/code\u003e缓存，\u003ccode\u003eJVM\u003c/code\u003e本地缓存，\u003ccode\u003ememcached\u003c/code\u003e等等。就拿\u003ccode\u003eRedis\u003c/code\u003e来说，它单机就能轻轻松松应对几万的并发，你读场景的业务，可以用缓存来抗高并发。\u003c/p\u003e\u003cp\u003e缓存虽然用得爽，但是要\u003cstrong\u003e注意缓存使用的一些问题\u003c/strong\u003e：\u003c/p\u003e\u003cp\u003e* 缓存与数据库的一致性问题\u003c/p\u003e\n\u003cp\u003e* 缓存雪崩\u003c/p\u003e\n\u003cp\u003e* 缓存穿透\u003c/p\u003e\n\u003cp\u003e* 缓存击穿\u003c/p\u003e\u003ch3\u003e7. CDN，加速静态资源访问 \u003ca href=\"#item-0-8\" id=\"item-0-8\"\u003e\u003c/a\u003e\u003c/h3\u003e\u003c/p\u003e\u003cp\u003e商品图片，\u003ccode\u003eicon\u003c/code\u003e等等静态资源，可以对页面做\u003cstrong\u003e静态化处理，减少访问服务端的请求\u003c/strong\u003e。如果用户分布在全国各地，有的在上海，有的在深圳，地域相差很远，网速也各不相同。为了让用户最快访问到页面，可以使用\u003ccode\u003eCDN\u003c/code\u003e。\u003ccode\u003eCDN\u003c/code\u003e可以让用户就近获取所需内容。\u003c/p\u003e\u003cp\u003e什么是CDN？\u003c/p\u003e\u003cp\u003e\u003e Content Delivery Network/Content Distribution Network,翻译过来就是内容分发网络，它表示将静态资源分发到位于多个地理位置机房的服务器，可以做到数据就近访问，加速了静态资源的访问速度，因此让系统更好处理正常别的动态请求。\u003c/p\u003e\u003cp\u003e\u003ch3\u003e8. 消息队列，削锋 \u003ca href=\"#item-0-9\" id=\"item-0-9\"\u003e\u003c/a\u003e\u003c/h3\u003e\u003cp\u003e我们搞一些双十一、双十二等运营活动时，需要\u003cstrong\u003e避免流量暴涨，打垮应用系统的风险\u003c/strong\u003e。因此一般会引入消息队列，来应对\u003cstrong\u003e高并发的场景\u003c/strong\u003e。\u003c/p\u003e\u003cimg src=\"/images/books/image_9_1.png\" alt=\"\" /\u003e\u003cp\u003e假设你的应用系统每秒最多可以处理\u003ccode\u003e2k\u003c/code\u003e个请求，每秒却有\u003ccode\u003e5k\u003c/code\u003e的请求过来，可以引入消息队列，应用系统每秒从消息队列拉\u003ccode\u003e2k\u003c/code\u003e请求处理得了。\u003c/p\u003e\u003cp\u003e有些伙伴担心这样可能会出现\u003cstrong\u003e消息积压\u003c/strong\u003e的问题：\u003c/p\u003e\u003cp\u003e* 首先，搞一些运营活动，不会每时每刻都那么多请求过来你的系统（\u003cstrong\u003e除非有人恶意攻击\u003c/strong\u003e），高峰期过去后，积压的请求可以慢慢处理；\u003c/p\u003e\n\u003cp\u003e* 其次，如果消息队列长度超过最大数量，可以直接抛弃用户请求或跳转到错误页面；\u003c/p\u003e\u003ch3\u003e9. ElasticSearch \u003ca href=\"#item-0-10\" id=\"item-0-10\"\u003e\u003c/a\u003e\u003c/h3\u003e\u003c/p\u003e\u003cp\u003e\u003ccode\u003eElasticsearch\u003c/code\u003e，大家都使用得比较多了吧，\u003cstrong\u003e一般搜索功能都会用到它\u003c/strong\u003e。它是一个分布式、高扩展、高实时的搜索与数据分析引擎，简称为\u003ccode\u003eES\u003c/code\u003e。\u003c/p\u003e\u003cp\u003e我们在聊高并发，为啥聊到\u003ccode\u003eES\u003c/code\u003e呢？因为\u003ccode\u003eES\u003c/code\u003e可以扩容方便，天然支撑高并发。\u003cstrong\u003e当数据量大的时候，不用动不动就加机器扩容，分库等等\u003c/strong\u003e，可以考虑用\u003ccode\u003eES\u003c/code\u003e来支持简单的查询搜索、统计类的操作。\u003c/p\u003e\u003cp\u003e\u003ch3\u003e10. 降级熔断 \u003ca href=\"#item-0-11\" id=\"item-0-11\"\u003e\u003c/a\u003e\u003c/h3\u003e\u003c/p\u003e\u003cp\u003e\u003cstrong\u003e熔断降级\u003c/strong\u003e是保护系统的一种手段。当前互联网系统一般都是分布式部署的。而分布式系统中偶尔会出现某个基础服务不可用，最终导致整个系统不可用的情况, 这种现象被称为\u003cstrong\u003e服务雪崩效应\u003c/strong\u003e。\u003c/p\u003e\u003cp\u003e比如分布式调用链路\u003ccode\u003eA-\u003eB-\u003eC....\u003c/code\u003e，下图所示：\u003c/p\u003e\u003cimg src=\"/images/books/image_8_1.png\" alt=\"\" /\u003e\u003cp\u003e\u003e 如果服务\u003ccode\u003eC\u003c/code\u003e出现问题，比如是因为慢\u003ccode\u003eSQL\u003c/code\u003e导致调用缓慢，那将导致\u003ccode\u003eB\u003c/code\u003e也会延迟，从而\u003ccode\u003eA\u003c/code\u003e也会延迟。堵住的\u003ccode\u003eA\u003c/code\u003e请求会消耗占用系统的线程、IO、CPU等资源。当请求\u003ccode\u003eA\u003c/code\u003e的服务越来越多，占用计算机的资源也越来越多，最终会导致系统瓶颈出现，造成其他的请求同样不可用，最后导致业务系统崩溃。\u003c/p\u003e\u003cp\u003e为了应对服务雪崩, 常见的做法是\u003cstrong\u003e熔断和降级\u003c/strong\u003e。最简单是加开关控制，当下游系统出问题时，开关打开降级，不再调用下游系统。还可以选用开源组件\u003ccode\u003eHystrix\u003c/code\u003e来支持。\u003c/p\u003e\u003cp\u003e你要保证设计的系统能应对\u003cstrong\u003e高并发场景\u003c/strong\u003e，那肯定要考虑\u003cstrong\u003e熔断降级\u003c/strong\u003e逻辑进来。\u003c/p\u003e\u003cp\u003e\u003ch3\u003e11. 限流 \u003ca href=\"#item-0-12\" id=\"item-0-12\"\u003e\u003c/a\u003e\u003c/h3\u003e\u003c/p\u003e\u003cp\u003e限流也是我们应对高并发的一种方案。我们当然希望，在高并发大流量过来时，系统能全部请求都正常处理。但是有时候没办法，系统的CPU、网络带宽、内存、线程等资源都是有限的。因此，我们要考虑限流。\u003c/p\u003e\u003cp\u003e如果你的系统每秒扛住的请求是一千，\u003cstrong\u003e如果一秒钟来了十万请求呢\u003c/strong\u003e？换个角度就是说，高并发的时候，流量洪峰来了，超过系统的承载能力，怎么办呢？\u003c/p\u003e\u003cp\u003e这时候，我们可以采取限流方案。就是为了保护系统，多余的请求，直接丢弃。\u003c/p\u003e\u003cp\u003e\u003e \u003cstrong\u003e什么是限流\u003c/strong\u003e：在计算机网络中，限流就是控制网络接口发送或接收请求的速率，它可防止DoS攻击和限制Web爬虫。限流，也称流量控制。是指系统在面临高并发，或者大流量请求的情况下，限制新的请求对系统的访问，从而保证系统的稳定性。\u003c/p\u003e\u003cp\u003e可以使用\u003ccode\u003eGuava\u003c/code\u003e的\u003ccode\u003eRateLimiter\u003c/code\u003e单机版限流，也可以使用\u003ccode\u003eRedis\u003c/code\u003e分布式限流，还可以使用阿里开源组件\u003ccode\u003esentinel\u003c/code\u003e限流。\u003c/p\u003e\u003cp\u003e面试的时候，你说到限流这块的话？面试官很大概率会问你限流的算法，因此，大家在准备面试的时候，需要复习一下这几种经典的限流算法哈\u003c/p\u003e\u003cp\u003e\u003ch3\u003e12. 异步 \u003ca href=\"#item-0-13\" id=\"item-0-13\"\u003e\u003c/a\u003e\u003c/h3\u003e\u003c/p\u003e\u003cp\u003e\u003e 回忆一下什么是同步，什么是异步呢？以\u003cstrong\u003e方法调用\u003c/strong\u003e为例，它代表\u003cstrong\u003e调用方要阻塞等待被调用方法中的逻辑执行完成\u003c/strong\u003e。这种方式下，当被调用方法响应时间较长时，会造成调用方长久的阻塞，在高并发下会造成整体系统性能下降甚至发生雪崩。异步调用恰恰相反，调用方不需要等待方法逻辑执行完成就可以返回执行其他的逻辑，在被调用方法执行完毕后再通过回调、事件通知等方式将结果反馈给调用方。\u003c/p\u003e\u003cp\u003e因此，设计一个高并发的系统，\u003cstrong\u003e需要在恰当的场景使用异步\u003c/strong\u003e。如何使用异步呢？后端可以借用消息队列实现。比如在海量秒杀请求过来时，先放到消息队列中，快速响应用户，告诉用户请求正在处理中，这样就可以释放资源来处理更多的请求。秒杀请求处理完后，通知用户秒杀抢购成功或者失败。\u003c/p\u003e\u003cp\u003e\u003ch3\u003e13. 接口的常规优化 \u003ca href=\"#item-0-14\" id=\"item-0-14\"\u003e\u003c/a\u003e\u003c/h3\u003e\u003c/p\u003e\u003cp\u003e设计一个高并发的系统，需要设计接口的性能足够好，这样系统在相同时间，就可以处理更多的请求。当说到这里的话，可以跟面试官说说接口优化的一些方案了。\u003c/p\u003e\u003cimg src=\"/images/books/image_31.png\" alt=\"\" /\u003e\u003cp\u003e\u003ch3\u003e14. 压力测试确定系统瓶颈 \u003ca href=\"#item-0-15\" id=\"item-0-15\"\u003e\u003c/a\u003e\u003c/h3\u003e\u003c/p\u003e\u003cp\u003e设计高并发系统，离不开最重要的一环，\u003cstrong\u003e就是压力测试\u003c/strong\u003e。就是在系统上线前，需要对系统进行压力测试，测清楚你的系统支撑的最大并发是多少，确定系统的瓶颈点，让自己心里有底，最好预防措施。\u003c/p\u003e\u003cp\u003e压测完要分析整个调用链路，性能可能出现问题是网络层（如带宽）、Nginx层、服务层、还是数据路缓存等中间件等等。\u003c/p\u003e\u003cp\u003e\u003ccode\u003eloadrunner\u003c/code\u003e是一款不错的压力测试工具，\u003ccode\u003ejmeter\u003c/code\u003e则是接口性能测试工具，都可以来做下压测。\u003c/p\u003e\u003cp\u003e\u003ch3\u003e15. 应对突发流量峰值：扩容+切流量 \u003ca href=\"#item-0-16\" id=\"item-0-16\"\u003e\u003c/a\u003e\u003c/h3\u003e\u003cp\u003e如果是突发的流量高峰，除了降级、限流保证系统不跨，我们可以采用这两种方案，保证系统尽可能服务用户请求：\u003c/p\u003e\u003cp\u003e* 扩容：\u003cstrong\u003e比如增加从库、提升配置的方式\u003c/strong\u003e，提升系统/组件的流量承载能力。比如增加\u003ccode\u003eMySQL、Redis\u003c/code\u003e从库来处理查询请求。\u003c/p\u003e\n\u003cp\u003e* 切流量：\u003cstrong\u003e服务多机房部署\u003c/strong\u003e，如果高并发流量来了，把流量从一个机房切换到另一个机房。\u003c/p\u003e\n"])</script><script>self.__next_f.push([1,"6:[\"$\",\"article\",null,{\"className\":\"py-24 sm:py-32\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-3xl px-6 lg:px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"xl:relative\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-2xl\",\"children\":[[\"$\",\"div\",null,{\"className\":\"text-center\",\"children\":[[\"$\",\"time\",null,{\"dateTime\":\"2024-03-17\",\"className\":\"text-gray-500\",\"children\":\"2024年03月17日\"}],[\"$\",\"h1\",null,{\"className\":\"mt-6 text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl\",\"children\":\"高并发系统设计的15个锦囊\"}],[\"$\",\"p\",null,{\"className\":\"mt-6 text-lg leading-8 text-gray-600\",\"children\":\"记得很久之前，去面试过**字节跳动**。被三面的面试官问了一道场景设计题目：**如何设计一个高并发系统**。当时我回答得比较粗糙，最近回想起来，所以整理了设计高并发系统的15个锦囊，相信大家看完会有帮助的。 所谓设计**高并发**系统，就是设计一个系统，保证它**整体可用**的同时，能够**处理很高...\"}],[\"$\",\"div\",null,{\"className\":\"mt-6 flex justify-center gap-2\",\"children\":[[\"$\",\"$L5\",\"系统架构\",{\"href\":\"/blog/tag/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/page/1\",\"className\":\"rounded-full bg-gray-100 px-3 py-1 text-sm font-medium text-gray-700 hover:bg-gray-200\",\"children\":\"系统架构\"}]]}]]}],[\"$\",\"div\",null,{\"className\":\"mt-16 prose prose-lg prose-gray mx-auto\",\"children\":[\"$\",\"div\",null,{\"className\":\"prose prose-lg prose-gray mx-auto\",\"dangerouslySetInnerHTML\":{\"__html\":\"$14\"}}]}],[\"$\",\"div\",null,{\"className\":\"mt-16 flex items-center justify-between border-t border-gray-200 pt-8\",\"children\":[\"$\",\"$L5\",null,{\"href\":\"/blog\",\"className\":\"relative z-10 rounded-md px-4 py-2 text-sm font-semibold leading-6 text-gray-900 hover:text-blue-600 hover:bg-gray-50\",\"children\":\"← 返回博客列表\"}]}],[\"$\",\"div\",null,{\"className\":\"mt-8 grid grid-cols-1 gap-8 border-t border-gray-200 pt-8 lg:grid-cols-2\",\"children\":[[\"$\",\"div\",null,{\"className\":\"group\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex items-center gap-x-3\",\"children\":[\"$\",\"div\",null,{\"className\":\"text-sm text-gray-500\",\"children\":\"上一篇\"}]}],[\"$\",\"h3\",null,{\"className\":\"mt-2 text-lg font-semibold leading-6 text-gray-900 group-hover:text-gray-600\",\"children\":[\"$\",\"$L5\",null,{\"href\":\"/blog/jia-gou-she-ji-mo-ban\",\"children\":[[\"$\",\"span\",null,{\"className\":\"absolute inset-0\"}],\"架构设计模板\"]}]}],[\"$\",\"p\",null,{\"className\":\"mt-3 text-sm leading-6 text-gray-600 line-clamp-2\",\"children\":\"最近一年的时间内，我参与了很多后端基础组件的设计、重构、重写、微服务化等工作，写了很多设计文档、与同事开了很多次技术研讨会，一直以来没有总结一套工作模板，以至于在开会时总有遗漏。今天我的朋友分享给了我一套架构设计模板，我针对文档做了一些总结，分享给大家： 总体来说，一个完善的设计需要考虑一下 11 ...\"}]]}],[\"$\",\"div\",null,{\"className\":\"group\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex items-center gap-x-3\",\"children\":[\"$\",\"div\",null,{\"className\":\"text-sm text-gray-500\",\"children\":\"下一篇\"}]}],[\"$\",\"h3\",null,{\"className\":\"mt-2 text-lg font-semibold leading-6 text-gray-900 group-hover:text-gray-600\",\"children\":[\"$\",\"$L5\",null,{\"href\":\"/blog/cong-0-kai-shi-zuo-yi-ge-hou-tai-jia-gou\",\"children\":[[\"$\",\"span\",null,{\"className\":\"absolute inset-0\"}],\"从0开始做一个后台项目架构\"]}]}],[\"$\",\"p\",null,{\"className\":\"mt-3 text-sm leading-6 text-gray-600 line-clamp-2\",\"children\":\"--- layout:   title:...\"}]]}]]}]]}]}]}]}]\n"])</script><script>self.__next_f.push([1,"9:null\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n8:null\n"])</script><script>self.__next_f.push([1,"b:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"Skyfalling\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"分享技术、生活和思考的个人博客\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/favicon.svg\"}]],\"error\":null,\"digest\":\"$undefined\"}\n13:{\"metadata\":\"$b:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script></body></html>